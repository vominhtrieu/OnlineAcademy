<%- include("partials/header", {title: "Đăng ký", css: ["auth"]}) %> <%-include("partials/navbar") %>

<link rel="stylesheet" href="/css/auth.css" />

<div class="container mt-5">
  <div class="card shadow-sm border-0">
    <div class="row">
      <div class="d-flex col-md-6 col-xs-12">
        <img class="w-100" src="assets/learning2.svg" />
      </div>

      <div class="col-md-6 col-xs-12">
        <div id="auth-container" class="mx-auto">
          <div class="card-body">
            <h4 class="card-title text-center mb-4 mt-1">Đăng ký</h4>
            <hr />
            <% if (message.length > 0) { %>
            <div class="alert alert-primary alert-dismissible fade show" role="alert">
              <%= message %>
              <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                <span aria-hidden="true">&times;</span>
              </button>
            </div>
            <% } %>
            <form id="sign-up-form" class="form-group mt-4" method="POST" action="/signup">
              <div class="input-group">
                <div class="input-group-prepend">
                  <span class="input-group-text"><i class="fa fa-envelope"></i></span>
                </div>
                <input type="text" name="email" id="email" placeholder="Email" class="form-control" aria-describedby="helpId" />
              </div>

              <div class="input-group my-3">
                <div class="input-group-prepend">
                  <span class="input-group-text"><i class="fa fa-user"></i></span>
                </div>
                <input type="text" name="fullName" id="full-name" placeholder="Họ và tên" class="form-control" aria-describedby="helpId" />
              </div>

              <div class="input-group my-3">
                <div class="input-group-prepend">
                  <span class="input-group-text"><i class="fa fa-lock"></i></span>
                </div>
                <input type="password" name="password" id="password" placeholder="Mật khẩu" class="form-control" aria-describedby="helpId" />
              </div>

              <div class="input-group my-3">
                <div class="input-group-prepend">
                  <span class="input-group-text"><i class="fa fa-lock"></i></span>
                </div>
                <input type="password" id="retype-password" placeholder="Nhập lại mật khẩu" class="form-control" aria-describedby="helpId" />
              </div>

              <input class="d-none" type="text" name="role" />

              <div class="mb-3">
                <div class="row">
                  <div class="col pr-1">
                    <button onclick="setRole('student')" type="button" class="w-100 btn btn-primary" id="student-select">Học viên</button>
                  </div>
                  <div class="col pl-1">
                    <button onclick="setRole('lecturer')" type="button" class="w-100 btn btn-outline-primary" id="lecturer-select">Giảng viên</button>
                  </div>
                </div>
              </div>

              <button id="submit-btn" class="btn btn-primary mt-2">Đăng ký</button>
            </form>

            <div class="or-container border-0">
              <div class="line-separator"></div>
              <div class="or-label">hoặc</div>
              <div class="line-separator"></div>
            </div>

            <div class="g-signin2" data-width="370" data-longtitle="true" data-onsuccess="onSignIn" data-theme="dark"></div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
  const signUpForm = document.getElementById('sign-up-form');
  const studentSelect = document.getElementById('student-select');
  const lecturerSelect = document.getElementById('lecturer-select');
  function setRole(role) {
    signUpForm.role.value = role;
    studentSelect.classList.toggle('btn-primary');
    studentSelect.classList.toggle('btn-outline-primary');
    lecturerSelect.classList.toggle('btn-primary');
    lecturerSelect.classList.toggle('btn-outline-primary');
  }

  function onSignIn(googleUser) {
    // Useful data for your client-side scripts:
    var profile = googleUser.getBasicProfile();
    console.log('ID: ' + profile.getId()); // Don't send this directly to your server!
    console.log('Full Name: ' + profile.getName());
    console.log('Given Name: ' + profile.getGivenName());
    console.log('Family Name: ' + profile.getFamilyName());
    console.log('Image URL: ' + profile.getImageUrl());
    console.log('Email: ' + profile.getEmail());

    // The ID token you need to pass to your backend:
    var id_token = googleUser.getAuthResponse().id_token;
    console.log('ID Token: ' + id_token);
  }

  function renderButton() {
    gapi.signin2.render('my-signin2', {
      scope: 'profile email',
      width: 500,
      height: 50,
      longtitle: true,
      theme: 'dark',
      onsuccess: onSuccess,
      onfailure: onFailure,
    });
  }
</script>
<%- include("partials/footer") %>
